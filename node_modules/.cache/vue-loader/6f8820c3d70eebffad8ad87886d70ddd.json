{"remainingRequest":"D:\\Programming\\Web\\project\\model-project\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\Programming\\Web\\project\\model-project\\src\\components\\ShareScreen.vue?vue&type=style&index=0&id=0a51ecaa&scoped=true&lang=css","dependencies":[{"path":"D:\\Programming\\Web\\project\\model-project\\src\\components\\ShareScreen.vue","mtime":1626613127830},{"path":"D:\\Programming\\Web\\project\\model-project\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programming\\Web\\project\\model-project\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1616796459000},{"path":"D:\\Programming\\Web\\project\\model-project\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Programming\\Web\\project\\model-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621594884307},{"path":"D:\\Programming\\Web\\project\\model-project\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogICANCiNzdGFydCB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgdG9wOiA0MCU7DQogIHdpZHRoOiAxMDAlOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCiNjb2RlLWlucHV0IHsNCiAgYm9yZGVyLXJhZGl1czogM3B4Ow0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICBwYWRkaW5nOiA1cHg7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBib3JkZXI6IG5vbmU7DQp9DQoNCiNzdGFydC1idXR0b24gew0KICBkaXNwbGF5OiBibG9jazsNCiAgbWFyZ2luOiBhdXRvOw0KICBwYWRkaW5nOiAxMHB4Ow0KICBmb250LXNpemU6IDE2cHg7DQogIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogIGNvbG9yOiB3aGl0ZTsNCiAgYm9yZGVyOiBub25lOw0KfQ0KDQojc3RhcnQtYnV0dG9uOm5vdCg6ZGlzYWJsZWQpIHsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwZjFjOw0KfQ0KDQojc3RhcnQtYnV0dG9uOmRpc2FibGVkIHsNCiAgY3Vyc29yOiBub3QtYWxsb3dlZCA7DQogIGJhY2tncm91bmQtY29sb3I6ICM3NjkxYTg7DQp9DQoNCnZpZGVvIHsNCiAgd2lkdGg6IDEwMCU7DQp9DQoNCiNjaGF0LXJvb20gew0KICBkaXNwbGF5OiBncmlkOw0KICBncmlkLWdhcDogMTZweDsNCiAgd2lkdGg6IDEwMCU7DQogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDNmcjsNCn0NCg0KI3JlbW90ZS12aWV3LWNvbnRhaW5lcnsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICBncmlkLWNvbHVtbjogMjsNCiAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7DQogIGhlaWdodDogOTV2aDsNCn0NCg0KI3NlbGYtdmlldyB7DQogIGdyaWQtY29sdW1uOiAxOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsNCiAgaGVpZ2h0OiAxMDAlOw0KICB3aWR0aDogMTAwJTsNCn0NCg0KI3JlbW90ZS12aWV3IHsNCiAgDQogIGdyaWQtY29sdW1uOiAxOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsNCiAgaGVpZ2h0OiAxMDAlOw0KICB3aWR0aDogMTAwJTsNCn0NCg0KI3ZpZXctYnV0dG9ucyB7DQogIG9wYWNpdHk6IDA7DQogIHRyYW5zaXRpb246IG9wYWNpdHkgMC41cyBlYXNlLW91dDsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICBib3JkZXItcmFkaXVzOiAzcHg7DQogIGJhY2tncm91bmQtY29sb3I6IGRhcmtncmF5Ow0KICBib3R0b206IDEwcHg7DQogIHBhZGRpbmc6IDEwcHg7DQogIGxlZnQ6IDA7DQogIHJpZ2h0OiAwOw0KICBtYXJnaW46IDIwcHg7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KI3ZpZXctYnV0dG9uczpob3ZlciB7DQogIG9wYWNpdHk6IDAuNzsNCn0NCg0KLnZpZXctYnV0dG9uIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogZGFya2dyYXk7DQogIGJvcmRlci1jb2xvcjogZGFya2dyYXk7DQogIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgZm9udC1zaXplOiAyMHB4Ow0KICBjb2xvcjogd2hpdGU7DQogIHBhZGRpbmc6IDVweDsNCiAgYm9yZGVyOiBub25lOw0KfQ0KDQoudmlldy1idXR0b246aG92ZXIgew0KICBjdXJzb3I6IHBvaW50ZXI7DQogIGJhY2tncm91bmQtY29sb3I6ICM3NTcyNzI7DQp9DQo="},{"version":3,"sources":["D:\\Programming\\Web\\project\\model-project\\src\\components\\ShareScreen.vue"],"names":[],"mappings":"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","file":"D:/Programming/Web/project/model-project/src/components/ShareScreen.vue","sourceRoot":"","sourcesContent":["<template>\r\n    <video id=\"remote-view\" autoplay></video>\r\n    <video id=\"self-view\" autoplay></video>\r\n    \r\n</template>\r\n\r\n\r\n<script>\r\n\r\nvar webSocket\r\nvar mapPeers = {}\r\nvar localStream = new MediaStream()\r\nvar username\r\nfunction sendSignal(action, message){\r\n  var jsonStr = JSON.stringify({\r\n      'peer': username,\r\n      'action': action,\r\n      'message': message\r\n    })\r\n  webSocket.send(jsonStr)\r\n}\r\nexport default {\r\n    setup() {\r\n        \r\n    },\r\n    data(){\r\n        return({\r\n            wsBackendUrl: 'localhost:8000',\r\n            wsStart: 'ws://',\r\n            isPresenting: null\r\n        })\r\n    },\r\n    methods:{\r\n        \r\n        async initializeStream(){\r\n            const localVideo = document.getElementById(\"self-view\")\r\n            var endPoint = this.wsStart + this.wsBackendUrl\r\n            webSocket = new WebSocket(endPoint)\r\n            webSocket.onopen =  function(e){\r\n                console.log(\"Connection Opened\");\r\n                sendSignal('new-peer', {})\r\n            }\r\n            webSocket.onclose = function(e){\r\n                console.log(\"Connection Closed\");\r\n            }\r\n            webSocket.onerror = function(e){\r\n                console.error(\"Error Occurred\");\r\n            }\r\n            webSocket.onmessage = this.webSocketOnMessage\r\n            if(this.role === \"host\" || this.role === \"presenter\"){\r\n              document.getElementById(\"remote-view\").style.display = \"none\"\r\n              console.log(this.$props.mode);\r\n              if(this.$props.mode === \"screen\"){\r\n                var userMedia = await window.navigator.mediaDevices.getDisplayMedia({\r\n                  video: true,\r\n                  audio: true\r\n                }).then(stream => {\r\n                    localStream = stream\r\n                    localVideo.srcObject = localStream\r\n                    localVideo.muted = true\r\n                }).catch(error => {\r\n                    console.error(error);\r\n                })\r\n              }\r\n              else if(this.$props.mode === \"microphone\"){\r\n                var userMedia = await window.navigator.mediaDevices.getUserMedia({\r\n                  audio: true\r\n                }).then(stream => {\r\n                    localStream = stream\r\n                    localVideo.srcObject = localStream\r\n                    localVideo.muted = true\r\n                }).catch(error => {\r\n                    console.error(error);\r\n                })\r\n                console.log(\"here\");\r\n              }\r\n              \r\n            }\r\n            else{\r\n              localVideo.style.display = \"none\";\r\n            }\r\n            \r\n        },\r\n        webSocketOnMessage(event){\r\n          var parsedData = JSON.parse(event.data)\r\n          var peerUsername = parsedData['peer']\r\n          var peerAction = parsedData['action']\r\n          if(peerUsername == this.username){\r\n            return\r\n          }\r\n          var receiver_channel_name = parsedData['message']['receiver_channel_name']\r\n          if(peerAction == 'new-peer'){\r\n            this.createOfferer(peerUsername, receiver_channel_name)\r\n            return \r\n          }\r\n          if(peerAction == 'new-offer'){\r\n            var offer = parsedData['message']['sdp']\r\n            this.createAnswerer(offer, peerUsername, receiver_channel_name)\r\n            return \r\n          }\r\n          if(peerAction == 'new-answer'){\r\n            var answer = parsedData['message']['sdp']\r\n            var peer = mapPeers[peerUsername][0]\r\n            peer.setRemoteDescription(answer)\r\n            return\r\n          }\r\n        },\r\n        \r\n        createOfferer(username, channel_room){\r\n          var peer = new RTCPeerConnection(null)\r\n          this.addLocalTrack(peer)\r\n          var dataChannel = peer.createDataChannel('channel')\r\n          dataChannel.addEventListener('open', () => {\r\n            console.log(\"Connection Opened\");\r\n          })\r\n          dataChannel.onmessage = this.dataChannelOnMessage\r\n          var remoteVideo = document.getElementById(\"remote-view\")\r\n          this.setOnTrack(peer, remoteVideo)\r\n          mapPeers[username] = [peer, dataChannel]\r\n          peer.oniceconnectionstatechange = function(){\r\n            document.getElementById(\"self\")\r\n            var iceConnectionState = peer.iceConnectionState\r\n            if(iceConnectionState === 'failed' || iceConnectionState === 'disconnected' || iceConnectionState === 'closed'){\r\n              delete mapPeers[username]\r\n              if(iceConnectionState !== 'closed'){\r\n                peer.close()\r\n              }\r\n              this.removeVideo(remoteVideo)\r\n            }\r\n          }\r\n          peer.onicecandidate = function(event){\r\n            if(event.candidate){\r\n              console.log(JSON.stringify(peer.localDescription));\r\n              return \r\n            }\r\n            sendSignal('new-offer', {\r\n              'sdp': peer.localDescription,\r\n              'receiver_channel_name': channel_room\r\n            })\r\n          },\r\n          \r\n          peer.createOffer().then(\r\n            o => peer.setLocalDescription(o).then(\r\n              () =>{\r\n                console.log(\"local description set successfully\"); \r\n              }\r\n            )\r\n          )\r\n        },\r\n        createAnswerer(offer, peerUsername, receiver_channel_name){\r\n          var peer = new RTCPeerConnection(null)\r\n          this.addLocalTrack(peer)\r\n          \r\n          var remoteVideo = document.getElementById(\"remote-view\")\r\n          this.setOnTrack(peer, remoteVideo)\r\n\r\n          peer.ondatachannel = function(e){\r\n            peer.dc = e.channel\r\n            peer.dc.addEventListener('open', () => {\r\n              console.log(\"Connection Opened\");\r\n            })\r\n            peer.dc.onmessage = this.dataChannelOnMessage\r\n            mapPeers[peerUsername] = [peer, peer.dc]\r\n          }\r\n          \r\n          \r\n          peer.oniceconnectionstatechange = function(){\r\n            var iceConnectionState = peer.iceConnectionState\r\n            if(iceConnectionState === 'failed' || iceConnectionState === 'disconnected' || iceConnectionState === 'closed'){\r\n              delete mapPeers[peerUsername]\r\n              if(iceConnectionState !== 'closed'){\r\n                peer.close()\r\n              }\r\n              this.removeVideo(remoteVideo)\r\n            }\r\n          }\r\n          peer.onicecandidate = function(event){\r\n            if(event.candidate){\r\n              console.log(JSON.stringify(peer.localDescription));\r\n              return \r\n            }\r\n            sendSignal('new-answer', {\r\n              'sdp': peer.localDescription,\r\n              'receiver_channel_name': receiver_channel_name\r\n            })\r\n          },\r\n          peer.setRemoteDescription(offer).then(\r\n            () => {\r\n              console.log(\"remote desctription set successfully for %s\", peerUsername);\r\n              return peer.createAnswer()\r\n            }\r\n          ).then(\r\n            a => {\r\n              console.log(\"Answer Created\");\r\n              peer.setLocalDescription(a)\r\n            }\r\n          )\r\n        },\r\n        addLocalTrack(peer){\r\n          localStream.getTracks().forEach(element => {\r\n            peer.addTrack(element, localStream)\r\n          })\r\n          return \r\n        },\r\n        dataChannelOnMessage(event){\r\n          var message = event.data\r\n\r\n        },\r\n        setOnTrack(peer, remoteVideo){\r\n          var remoteStream = new MediaStream()\r\n          remoteVideo.srcObject = remoteStream\r\n          peer.ontrack = function(event){\r\n            remoteStream.addTrack(event.track, remoteStream) \r\n          }\r\n        },\r\n\r\n\r\n    },\r\n    mounted(){\r\n        this.initializeStream()\r\n        username = this.$props.username\r\n        console.log(this.$props.role);\r\n        if(this.$props.role === \"host\" || this.$props.role === \"presenter\"){\r\n          this.isPresenting = true  \r\n        }\r\n        \r\n    },\r\n    props:[\r\n      'username',\r\n      'role',\r\n      'mode'\r\n    ]\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n   \r\n#start {\r\n  position: relative;\r\n  top: 40%;\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n\r\n#code-input {\r\n  border-radius: 3px;\r\n  margin-bottom: 20px;\r\n  padding: 5px;\r\n  font-size: 16px;\r\n  text-align: center;\r\n  border: none;\r\n}\r\n\r\n#start-button {\r\n  display: block;\r\n  margin: auto;\r\n  padding: 10px;\r\n  font-size: 16px;\r\n  border-radius: 3px;\r\n  font-weight: bold;\r\n  color: white;\r\n  border: none;\r\n}\r\n\r\n#start-button:not(:disabled) {\r\n  cursor: pointer;\r\n  background-color: #000f1c;\r\n}\r\n\r\n#start-button:disabled {\r\n  cursor: not-allowed ;\r\n  background-color: #7691a8;\r\n}\r\n\r\nvideo {\r\n  width: 100%;\r\n}\r\n\r\n#chat-room {\r\n  display: grid;\r\n  grid-gap: 16px;\r\n  width: 100%;\r\n  grid-template-columns: 1fr 3fr;\r\n}\r\n\r\n#remote-view-container{\r\n  position: relative;\r\n  grid-column: 2;\r\n  background-color: black;\r\n  height: 95vh;\r\n}\r\n\r\n#self-view {\r\n  grid-column: 1;\r\n  background-color: black;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n#remote-view {\r\n  \r\n  grid-column: 1;\r\n  background-color: black;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n#view-buttons {\r\n  opacity: 0;\r\n  transition: opacity 0.5s ease-out;\r\n  position: absolute;\r\n  border-radius: 3px;\r\n  background-color: darkgray;\r\n  bottom: 10px;\r\n  padding: 10px;\r\n  left: 0;\r\n  right: 0;\r\n  margin: 20px;\r\n  text-align: center;\r\n}\r\n\r\n#view-buttons:hover {\r\n  opacity: 0.7;\r\n}\r\n\r\n.view-button {\r\n  background-color: darkgray;\r\n  border-color: darkgray;\r\n  border-radius: 3px;\r\n  font-size: 20px;\r\n  color: white;\r\n  padding: 5px;\r\n  border: none;\r\n}\r\n\r\n.view-button:hover {\r\n  cursor: pointer;\r\n  background-color: #757272;\r\n}\r\n</style>"]}]}