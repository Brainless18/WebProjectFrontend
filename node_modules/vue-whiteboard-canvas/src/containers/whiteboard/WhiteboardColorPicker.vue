<template>

  <article  class="color-picker-container">
    <input
      type="button"
      @blur="states.showPicker = false"
      @click="states.showPicker = !states.showPicker"
      class="color-picker-circle"
      :style="styles.colorPickerCircle"
    />

    <transition name="slide-fade">
      <div v-show="states.showPicker" ref="colorPicker"></div>

    </transition>

  </article>
</template>

<script>
import {ref, reactive, computed, onMounted} from 'vue';
import iro from "@jaames/iro";
import {useColorStore} from "./store/color";


export default {
  name: 'WhiteboardColorPicker',
  setup() {
    const colorPicker = ref(null);
    const {colorSelected} = useColorStore();
    const states = reactive({
      showPicker: false,
    });


    onMounted(() => {
      const picker = new iro.ColorPicker(colorPicker.value, {
        width: 250,
        color: colorSelected.value,
        layout: [
          {
            component: iro.ui.Wheel,
            options: {
              borderColor: '#ffffff'
            }
          },
          {
            component: iro.ui.Slider,
            options: {
              borderColor: '#000000',
              sliderType: 'value'
            }
          }
        ]

      });

      picker.on('color:change', function (color){
        colorSelected.value = color.hexString;
      });
    })

    const styles = computed(() => {
      return {
        colorPickerCircle: {
          backgroundColor: colorSelected.value
        }
      }
    });

    return {
      states,
      styles,
      colorPicker,
      colorSelected,
    }
  },
  props: {},


}
</script>

<style scoped lang="scss">
.color-picker-container{
  margin: 20px;
  position: absolute;
  z-index: 1000;

}

.color-picker-circle{
  border-radius: 50%;
  width: 30px;
  height: 30px;
  cursor: pointer;
  border-width: 1px;
  &:focus{
    outline: none;
  }
  &:hover{
    border: grey solid 3px;

  }
}


/* Enter and leave animations can use different */
/* durations and timing functions.              */
.slide-fade-enter-active {
  transition: all 0.3s ease-out;
}

.slide-fade-leave-active {
  transition: all 0.3s cubic-bezier(1, 0.5, 0.8, 1);
}

.slide-fade-enter-from,
.slide-fade-leave-to {
  transform: translateY(-20px);
  opacity: 0;

}
</style>
