import { ref, computed, reactive } from 'vue';
import {useWhiteboardStore} from "./whiteboard";

const {} = useWhiteboardStore();

// the quill html container in the dom
const quill = ref({});
const quillToolbar = ref({});
// quill instance
const editor = ref({});

// const editorXPos = computed( () => {
//   return lastMouseClickPos.xPos;
// });
// const editorYPos = computed( () => {
//   return lastMouseClickPos.yPos;
// });

// computed
// if double click on a text img, set x and y pos to edge of img
//

const states = reactive({
  showToolbar: false,
});

const getToolbarHeight = () => {
  const toolbar = document.querySelector('#whiteboard-container .ql-toolbar');
  return toolbar?.clientHeight;
};

const removeQuillEditor = () => {
  const container = document.getElementById('quill-container');
  container.innerHTML = '';
  container.className = '';
  // quill.value = {};
  editor.value = {};
  removeQuillToolbar();
}

const removeQuillToolbar = () => {
  const container = document.getElementById('whiteboard-container');
  container.querySelectorAll('.ql-toolbar').forEach(toolbar => toolbar.remove());
}

export function useQuillStore(){

  return {
    states,
    getToolbarHeight,
    editor,
    quill,
    quillToolbar,
    removeQuillEditor,
    removeQuillToolbar,
    // editorXPos,
    // editorYPos
  }
}
