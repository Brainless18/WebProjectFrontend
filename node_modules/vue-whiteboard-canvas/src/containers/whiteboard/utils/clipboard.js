import {useWhiteboardStore} from "../store/whiteboard";
import Konva from "konva";


const {layer, lastMouseClickPos} = useWhiteboardStore();

const copy = async (content) => {
//  content should be konva node
//  check if image

//  if not convert to image? or see if able to copy


}

const paste = async () => {
  const clipboardContent = (await navigator.clipboard.read())[0];


  try{
    const blob = await clipboardContent.getType('image/png');
    const blobUri = window.URL.createObjectURL(blob);

    const image = new window.Image();
    image.src = blobUri;

    Konva.Image.fromURL(blobUri, function (konvaImg) {
      konvaImg.setAttrs({
        x: lastMouseClickPos.xPos,
        y: lastMouseClickPos.yPos,
        draggable: true,
      })
      layer.value.add(konvaImg);
      layer.value.draw();
    })


  }catch (err){
    console.log(err);

  }



  // for (let ii = 0; ii < clipboardContent.length; ii ++) {
  //   console.log({content});
  //
  //
  //
  //
  // }

  // const reader = new FileReader();

  // console.log(clipboardContent.files)
  // console.log(clipboardContent.dropEffect)
  // console.log(clipboardContent.effectAllowed)
  // console.log(clipboardContent.items)
  // console.log(clipboardContent.types)

}

export const useClipboard = () => {
  return {
    paste,
    copy,
  }
}
