import Quill from "quill";
import useText from "../../tools/useText";
import {useWhiteboardStore} from "../../../store/whiteboard";
import {useQuillStore} from "../../../store/quill";
import Konva from "konva";
import {useTransformer} from "../../../utils/transformer/transformer";

const {toolSelected, setToolSelected } = useWhiteboardStore();
const {editor} = useQuillStore();
const {swapQuillWithImage} = useText();
const {clearTransformer} = useTransformer();

export const onToolChange = async (toolName) => {
  //if current tool is text
  if(toolSelected.value.toLowerCase() === 'text' && editor.value instanceof Quill){
    // this will convert quill editor into image node
    await swapQuillWithImage();
  }
  if(toolName.toLowerCase() !== 'move'){
    clearTransformer();
  }


  switch (toolName.toLowerCase()){
    case 'text':
      setToolSelected('text');
      break;
    case 'pencil':
      setToolSelected('pencil');
      break;
    case 'move':
      setToolSelected('move');
      break;
    case 'line':
      setToolSelected('line');
      break;
    case 'pan':
      setToolSelected('pan');
      break;
    case 'rectangle':
      setToolSelected('rectangle');
      break;
    case 'circle':
      setToolSelected('circle');
      break;
    case 'clear all':
      break;
    default:
      console.error('Unknown tool', toolName);
      break;
  }
}
